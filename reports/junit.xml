<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="30" time="5.281" timestamp="2025-11-09T10:44:25.541310-05:00" hostname="Scotts-MacBook-Pro.local"><testcase classname="tests.test_agent_amazon" name="test_graph_has_amazon_not_keepa" time="0.001" /><testcase classname="tests.test_agent_amazon" name="test_integration_amazon_results_have_source_amazon" time="0.009" /><testcase classname="tests.test_agent_amazon" name="test_ui_amazon_search_schema_smoke" time="0.591" /><testcase classname="tests.test_clustering" name="test_normalize_text_basic" time="0.000" /><testcase classname="tests.test_clustering" name="test_tokens_and_blocking_key_deterministic" time="0.000" /><testcase classname="tests.test_clustering" name="test_normalize_brand_aliases" time="0.000" /><testcase classname="tests.test_clustering" name="test_embed_texts_cosine_similarity_monotonic" time="0.001" /><testcase classname="tests.test_clustering" name="test_dsu_union_find_basic" time="0.000" /><testcase classname="tests.test_clustering" name="test_cluster_block_respects_brand_gate_and_theta" time="0.002" /><testcase classname="tests.test_clustering" name="test_cluster_block_threshold_border" time="0.001" /><testcase classname="tests.test_clustering" name="test_stable_uuid_determinism" time="0.000" /><testcase classname="tests.test_clustering" name="test_cluster_products_end_to_end_aggregates_and_memberships" time="0.004" /><testcase classname="tests.test_clustering" name="test_cluster_products_empty_input" time="0.000" /><testcase classname="tests.test_metrics" name="test_purity_perfect_two_clusters" time="0.001" /><testcase classname="tests.test_metrics" name="test_purity_mixed_cluster" time="0.000" /><testcase classname="tests.test_metrics" name="test_purity_all_singletons_equals_label_accuracy" time="0.000" /><testcase classname="tests.test_metrics" name="test_purity_empty_pred_is_zero" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_perfect_match" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_all_singletons_vs_grouped_gold_is_zero" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_partial_merge" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_order_invariance" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_empty_everything_is_zero" time="0.000" /><testcase classname="tests.test_metrics" name="test_f1_pred_has_pairs_but_no_labels_is_zero" time="0.000" /><testcase classname="tests.test_aggregator" name="test_stats_and_medoid_for_simple_cluster" time="0.001" /><testcase classname="tests.test_aggregator" name="test_brand_gate_splits_clusters_when_brands_differ" time="0.002" /><testcase classname="tests.test_aggregator" name="test_upc_groups_split_by_brand_purity" time="0.001" /><testcase classname="tests.test_aggregator" name="test_blocking_key_is_deterministic_and_brand_sensitive" time="0.000" /><testcase classname="tests.test_aggregator" name="test_stable_uuid_is_deterministic_for_same_inputs" time="0.000" /><testcase classname="tests.test_aggregator" name="test_embed_texts_normalizes_and_nonzero_vectors" time="0.000" /><testcase classname="tests.test_vector_pg_integration" name="test_pgvector_round_trip" time="0.112"><failure message="psycopg.OperationalError: [Errno 8] nodename nor servname provided, or not known">pg_env = 'postgresql://user:pass@host:5432/dbname'
monkeypatch = &lt;_pytest.monkeypatch.MonkeyPatch object at 0x12f06a250&gt;

    @pytest.mark.usefixtures("pg_env")
    def test_pgvector_round_trip(pg_env, monkeypatch):
        import psycopg
        table = os.getenv("PGVECTOR_TABLE", "product_embeddings")
        dim = int(os.getenv("PGVECTOR_DIM", "384"))
    
        # Force supabase backend in this test
        monkeypatch.setenv("VECTOR_BACKEND", "supabase")
    
        # Connect &amp; ensure table
&gt;       conn = psycopg.connect(pg_env)
               ^^^^^^^^^^^^^^^^^^^^^^^

tests/test_vector_pg_integration.py:40: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.13/site-packages/psycopg/connection.py:98: in connect
    attempts = conninfo_attempts(params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

params = {'dbname': 'dbname', 'host': 'host', 'password': 'pass', 'port': '5432', ...}

    def conninfo_attempts(params: ConnMapping) -&gt; list[ConnDict]:
        """Split a set of connection params on the single attempts to perform.
    
        A connection param can perform more than one attempt more than one ``host``
        is provided.
    
        Also perform async resolution of the hostname into hostaddr. Because a host
        can resolve to more than one address, this can lead to yield more attempts
        too. Raise `OperationalError` if no host could be resolved.
    
        Because the libpq async function doesn't honour the timeout, we need to
        reimplement the repeated attempts.
        """
        last_exc = None
        attempts = []
        if prefer_standby := (
            get_param(params, "target_session_attrs") == "prefer-standby"
        ):
            params = {k: v for k, v in params.items() if k != "target_session_attrs"}
    
        for attempt in split_attempts(params):
            try:
                attempts.extend(_resolve_hostnames(attempt))
            except OSError as ex:
                logger.debug("failed to resolve host %r: %s", attempt.get("host"), ex)
                last_exc = ex
    
        if not attempts:
            assert last_exc
            # We couldn't resolve anything
&gt;           raise e.OperationalError(str(last_exc))
E           psycopg.OperationalError: [Errno 8] nodename nor servname provided, or not known

.venv/lib/python3.13/site-packages/psycopg/_conninfo_attempts.py:53: OperationalError</failure></testcase></testsuite></testsuites>